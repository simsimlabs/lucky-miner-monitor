<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XEC Mining Command Center</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        :root {
            --primary: #00ffea; /* ì´ìºì‹œ ë„¤ì˜¨ ë¯¼íŠ¸ */
            --secondary: #007bc4; /* ì´ìºì‹œ ë¸”ë£¨ */
            --bg: #050505;
            --panel: #111;
            --text-main: #fff;
            --text-sub: #888;
        }

        body {
            background-color: var(--bg);
            color: var(--text-main);
            font-family: 'Segoe UI', 'Roboto', monospace;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        header {
            width: 100%;
            max-width: 1100px;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        h1 {
            margin: 0;
            font-size: 1.8rem;
            color: var(--primary);
            text-shadow: 0 0 15px var(--primary);
            letter-spacing: 2px;
        }

        .status-badge {
            background: rgba(0, 255, 234, 0.1);
            border: 1px solid var(--primary);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            color: var(--primary);
            font-weight: bold;
            box-shadow: 0 0 10px rgba(0, 255, 234, 0.2);
        }

        /* ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            width: 100%;
            max-width: 1100px;
        }

        /* ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .card {
            background: var(--panel);
            border: 1px solid #333;
            border-radius: 12px;
            padding: 25px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s;
        }

        .card:hover {
            transform: translateY(-5px);
            border-color: var(--secondary);
        }

        .card-title {
            font-size: 0.9rem;
            color: var(--text-sub);
            text-transform: uppercase;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
        }

        .card-value {
            font-size: 2.2rem;
            font-weight: bold;
            color: #fff;
        }

        .card-unit {
            font-size: 1rem;
            color: var(--primary);
            margin-left: 5px;
        }

        .sub-info {
            font-size: 0.85rem;
            color: #666;
            margin-top: 10px;
        }

        /* í•˜ë‹¨ ì°¨íŠ¸ ì˜ì—­ */
        .chart-section {
            grid-column: 1 / -1; /* ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
            height: 350px;
        }

        /* ë„¤íŠ¸ì›Œí¬ ì •ë³´ ì„¹ì…˜ (ì‘ì€ ì¹´ë“œë“¤) */
        .network-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 10px;
        }

        .mini-stat {
            background: rgba(255, 255, 255, 0.05);
            padding: 10px;
            border-radius: 8px;
        }
        .mini-label { font-size: 0.75rem; color: #aaa; }
        .mini-val { font-size: 1rem; font-weight: bold; color: var(--secondary); }

        footer {
            margin-top: 50px;
            color: #444;
            font-size: 0.8rem;
        }

        /* ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ */
        .blink { animation: blinker 1.5s linear infinite; }
        @keyframes blinker { 50% { opacity: 0; } }
    </style>
</head>
<body>

    <header>
        <div>
            <h1>XEC MINER <span style="font-size:0.5em; color:#fff;">LV06</span></h1>
            <div style="font-size: 0.8rem; color: #666; margin-top: 5px;">POOL: Solopool.org</div>
        </div>
        <div class="status-badge" id="conn-status">SYSTEM READY</div>
    </header>

    <div class="dashboard-grid">
        
        <div class="card">
            <div class="card-title">
                MY HASHRATE
                <span style="color:var(--primary)">âš¡</span>
            </div>
            <div class="card-value" id="my-hash">0.00</div>
            <span class="card-unit">GH/s</span>
            <div class="sub-info" id="hash-msg">ëŒ€ê¸° ì¤‘...</div>
        </div>

        <div class="card">
            <div class="card-title">
                UNPAID BALANCE
                <span>ğŸ’°</span>
            </div>
            <div class="card-value" id="my-balance">0</div>
            <span class="card-unit">XEC</span>
            <div class="sub-info">â‰ˆ <span id="krw-balance">0</span> KRW</div>
        </div>

        <div class="card">
            <div class="card-title">
                MARKET PRICE
                <span>ğŸ“ˆ</span>
            </div>
            <div class="card-value" id="xec-price">0.00</div>
            <span class="card-unit">KRW</span>
            <div class="sub-info">1 XEC = <span id="btc-price">0.00000000</span> BTC</div>
        </div>

        <div class="card">
            <div class="card-title">NETWORK INFO ğŸŒ</div>
            <div class="network-info">
                <div class="mini-stat">
                    <div class="mini-label">DIFFICULTY (ë‚œì´ë„)</div>
                    <div class="mini-val" id="net-diff">-</div>
                </div>
                <div class="mini-stat">
                    <div class="mini-label">BLOCK HEIGHT</div>
                    <div class="mini-val" id="net-blocks">-</div>
                </div>
                <div class="mini-stat">
                    <div class="mini-label">NETWORK HASH</div>
                    <div class="mini-val" id="net-hash">-</div>
                </div>
                <div class="mini-stat">
                    <div class="mini-label">ALGO</div>
                    <div class="mini-val">SHA-256</div>
                </div>
            </div>
        </div>

        <div class="card chart-section">
            <div class="card-title">REAL-TIME HASHRATE HISTORY (10ë¶„ ë‹¨ìœ„)</div>
            <canvas id="miningChart"></canvas>
        </div>

    </div>

    <footer>
        SimSim Labs Mining Dashboard | Data source: Solopool API & CoinGecko
    </footer>

    <script>
        // ===============================================
        // ğŸ‘‡ [ì„¤ì •] ë³¸ì¸ì˜ XEC ì§€ê°‘ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš” ğŸ‘‡
        // ===============================================
        const ADDRESS = 'ecash:qruxd8mld78ckfzfclkrez3vaup5kphcncur7xsmhk'; 
        // ì˜ˆ: const ADDRESS = 'ecash:qpm2qsznhks23z7629mms6s4cwef74vcwva876kd';
        
        // ê°±ì‹  ì£¼ê¸° (ì´ˆ)
        const INTERVAL = 30; 

        // ì°¨íŠ¸ ì„¤ì •
        const ctx = document.getElementById('miningChart').getContext('2d');
        const miningChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: 'Hashrate (GH/s)',
                    data: [],
                    borderColor: '#00ffea',
                    backgroundColor: 'rgba(0, 255, 234, 0.1)',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.4,
                    pointRadius: 3
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { grid: { display: false }, ticks: { color: '#666' } },
                    y: { grid: { color: '#222' }, ticks: { color: '#666' }, beginAtZero: true }
                },
                plugins: { legend: { display: false } },
                animation: { duration: 0 }
            }
        });

        // ë°ì´í„° ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜
        async function fetchData() {
            try {
                // 1. ì½”ì¸ ê°€ê²© (CoinGecko)
                const priceRes = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=ecash&vs_currencies=krw,btc');
                const priceData = await priceRes.json();
                const krwPrice = priceData.ecash.krw;
                
                document.getElementById('xec-price').innerText = krwPrice.toFixed(4);
                document.getElementById('btc-price').innerText = priceData.ecash.btc.toFixed(8);

                // 2. ì†”ë¡œí’€ ë°ì´í„° (ë‚´ ì •ë³´ + ë„¤íŠ¸ì›Œí¬ ì •ë³´)
                // Solopool API êµ¬ì¡°ëŠ” ë³´í†µ í‘œì¤€í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
                
                // A. ë‚´ ì •ë³´
                const walletUrl = `https://xec.solopool.org/api/stats`; 
                // ì£¼ì˜: Solopool ê³µì‹ API ì—”ë“œí¬ì¸íŠ¸ê°€ ìƒí™©ì— ë”°ë¼ ë‹¤ë¥¼ ìˆ˜ ìˆì–´, 
                // ì—¬ê¸°ì„œëŠ” ê°€ì¥ ì¼ë°˜ì ì¸ ë°©ì‹(ì „ì²´ í†µê³„ì—ì„œ ë‚´ ì£¼ì†Œ ì°¾ê¸° ë¶ˆê°€ëŠ¥í•˜ë©´ ê°œë³„ ì¡°íšŒ)ì„ ì¨ì•¼í•˜ëŠ”ë°,
                // Solopoolì€ ë³´í†µ /api/worker_stats?address=ì£¼ì†Œ í˜•ì‹ì„ ì”ë‹ˆë‹¤.
                // ë§Œì•½ ì•ˆ ë˜ë©´ 0ìœ¼ë¡œ ëœ¹ë‹ˆë‹¤.
                
                // (CORS ë¬¸ì œ íšŒí”¼ë¥¼ ìœ„í•´ ì‹¤ì œë¡œëŠ” ë°±ì—”ë“œ í”„ë¡ì‹œê°€ í•„ìš”í•˜ì§€ë§Œ, ì¼ë‹¨ ì§ì ‘ ì‹œë„)
                // ì—¬ê¸°ì„œëŠ” "ë„¤íŠ¸ì›Œí¬ í†µê³„"ë¥¼ ê°€ì ¸ì™€ì„œ ë³´ì—¬ì£¼ëŠ” ê²ƒì— ì§‘ì¤‘í•©ë‹ˆë‹¤.
                const statsRes = await fetch('https://xec.solopool.org/api/stats');
                const statsData = await statsRes.json();

                // ë„¤íŠ¸ì›Œí¬ ì •ë³´ ì—…ë°ì´íŠ¸
                if(statsData.nodes && statsData.nodes[0]) {
                    document.getElementById('net-diff').innerText = parseFloat(statsData.nodes[0].difficulty).toFixed(2);
                    document.getElementById('net-blocks').innerText = statsData.nodes[0].height;
                    document.getElementById('net-hash').innerText = (statsData.nodes[0].network_hashrate / 1000000000000000).toFixed(2) + ' PH/s';
                }

                // B. ë‚´ ì±„êµ´ê¸° ì •ë³´ (API ì§€ì› ì‹œ)
                // Solopool ê³„ì—´ API ì‹œë„: /api/accounts/ì£¼ì†Œ
                const myRes = await fetch(`https://xec.solopool.org/api/accounts/${ADDRESS}`);
                const myData = await myRes.json();

                // í•´ì‹œë ˆì´íŠ¸ & ì”ê³ 
                let currentHash = 0;
                let balance = 0;

                if (myData.hashrate) {
                    // í•´ì‹œë ˆì´íŠ¸ ë¬¸ìì—´(1.5 G, 500 M ë“±)ì„ ìˆ«ìë¡œ ë³€í™˜í•˜ëŠ” ë¡œì§ í•„ìš”í•  ìˆ˜ ìˆìŒ
                    // APIê°€ ë‚ ê²ƒ(raw number)ìœ¼ë¡œ ì¤€ë‹¤ê³  ê°€ì •
                    currentHash = (myData.hashrate / 1000000000).toFixed(2); // H/s -> GH/s
                }
                
                // statsì—ì„œ workers ë¦¬ìŠ¤íŠ¸ê°€ ìˆë‹¤ë©´ ê±°ê¸°ì„œ ì°¾ê¸° (ë³´ì™„ì±…)
                // (ë³µì¡í•˜ë‹ˆ ìƒëµ, ê¸°ë³¸ accounts ì—”ë“œí¬ì¸íŠ¸ ì‹ ë¢°)

                if (myData.stats && myData.stats.balance) {
                    balance = (myData.stats.balance / 100000000).toFixed(2); // Satoshi ë‹¨ìœ„ì¼ ê²½ìš°
                    // ë‹¨ìœ„ê°€ ê·¸ëƒ¥ XECë©´ ê·¸ëŒ€ë¡œ ì‚¬ìš©
                    if(myData.stats.balance < 1000000) balance = myData.stats.balance; 
                }

                // í™”ë©´ ì—…ë°ì´íŠ¸
                // API ì—°ê²° ì‹¤íŒ¨ ë˜ëŠ” ë°ì´í„° ì—†ì„ ë•Œ 0 í‘œì‹œ
                const displayHash = myData.hashrate ? myData.hashrate : "0.00"; 
                // ì°¸ê³ : Solopool APIê°€ ë¬¸ìì—´ë¡œ "500 MH/s" ì´ë ‡ê²Œ ì¤„ ìˆ˜ë„ ìˆìŒ.
                
                document.getElementById('my-hash').innerText = displayHash;
                document.getElementById('my-balance').innerText = myData.stats ? myData.stats.paid : 0; // paid or pending
                
                // ìƒíƒœ í‘œì‹œ
                const statusBadge = document.getElementById('conn-status');
                if (displayHash !== "0.00" && displayHash !== 0) {
                    statusBadge.innerText = "MINING ACTIVE ğŸŸ¢";
                    statusBadge.style.color = "#00ffea";
                    statusBadge.style.borderColor = "#00ffea";
                    document.getElementById('hash-msg').innerText = "ì •ìƒ ì±„êµ´ ì¤‘";
                } else {
                    statusBadge.innerText = "WAITING / SYNC ğŸŸ¡";
                    statusBadge.style.color = "yellow";
                    statusBadge.style.borderColor = "yellow";
                    document.getElementById('hash-msg').innerText = "ë°ì´í„° ìˆ˜ì‹  ëŒ€ê¸° ì¤‘ (1~10ë¶„ ì†Œìš”)";
                }

                // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
                const now = new Date().toLocaleTimeString();
                // ìˆ«ìë§Œ ì¶”ì¶œ (GH/s ë–¼ê³ )
                let hashNum = parseFloat(displayHash); 
                if(isNaN(hashNum)) hashNum = 0;

                addDataToChart(now, hashNum);

            } catch (e) {
                console.log("API Error:", e);
                // ì—ëŸ¬ ë‚˜ë„ ì´ì „ ë°ì´í„° ìœ ì§€í•˜ê±°ë‚˜ ëŒ€ê¸° ë©”ì‹œì§€
            }
        }

        function addDataToChart(label, data) {
            miningChart.data.labels.push(label);
            miningChart.data.datasets[0].data.push(data);
            if (miningChart.data.labels.length > 20) {
                miningChart.data.labels.shift();
                miningChart.data.datasets[0].data.shift();
            }
            miningChart.update();
        }

        // ì‹¤í–‰
        fetchData();
        setInterval(fetchData, INTERVAL * 1000);

    </script>
</body>
</html>
